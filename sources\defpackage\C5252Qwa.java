package defpackage;

import android.content.Intent;
import android.net.Uri;
import androidx.fragment.app.FragmentActivity;
import com.soundcloud.android.image.C3721b;
import java.util.concurrent.TimeUnit;

@EVa(d1 = {"\u0000v\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\b\f\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u0002\n\u0000\n\u0002\u0010\u000e\n\u0002\b\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\b\u0007\b\u0016\u0018\u0000 12\u00020\u0001:\u000512345BI\b\u0007\u0012\u0006\u0010\u0002\u001a\u00020\u0003\u0012\u0006\u0010\u0004\u001a\u00020\u0005\u0012\u0006\u0010\u0006\u001a\u00020\u0007\u0012\u0006\u0010\b\u001a\u00020\t\u0012\u0006\u0010\n\u001a\u00020\u000b\u0012\u0006\u0010\f\u001a\u00020\r\u0012\u0006\u0010\u000e\u001a\u00020\u000f\u0012\b\b\u0001\u0010\u0010\u001a\u00020\u0011¢\u0006\u0002\u0010\u0012J\u0018\u0010\u001d\u001a\u00020\u001e2\u0006\u0010\u001f\u001a\u00020 2\u0006\u0010!\u001a\u00020\"H\u0012J\b\u0010#\u001a\u00020$H\u0016J\u0010\u0010%\u001a\u00020&2\u0006\u0010'\u001a\u00020&H\u0012J\u001e\u0010(\u001a\b\u0012\u0004\u0012\u00020\u001e0)2\u0006\u0010\u001f\u001a\u00020 2\u0006\u0010*\u001a\u00020+H\u0016J\u0016\u0010,\u001a\b\u0012\u0004\u0012\u00020-0)2\u0006\u0010.\u001a\u00020/H\u0012J\u0014\u00100\u001a\u00020$*\u00020\u001e2\u0006\u0010!\u001a\u00020\"H\u0012R\u0014\u0010\b\u001a\u00020\tX\u0004¢\u0006\b\n\u0000\u001a\u0004\b\u0013\u0010\u0014R\u000e\u0010\u0006\u001a\u00020\u0007X\u0004¢\u0006\u0002\n\u0000R\u000e\u0010\u0004\u001a\u00020\u0005X\u0004¢\u0006\u0002\n\u0000R\u000e\u0010\u0002\u001a\u00020\u0003X\u0004¢\u0006\u0002\n\u0000R\u0014\u0010\u0010\u001a\u00020\u0011X\u0004¢\u0006\b\n\u0000\u001a\u0004\b\u0015\u0010\u0016R\u0014\u0010\f\u001a\u00020\rX\u0004¢\u0006\b\n\u0000\u001a\u0004\b\u0017\u0010\u0018R\u0014\u0010\n\u001a\u00020\u000bX\u0004¢\u0006\b\n\u0000\u001a\u0004\b\u0019\u0010\u001aR\u0014\u0010\u000e\u001a\u00020\u000fX\u0004¢\u0006\b\n\u0000\u001a\u0004\b\u001b\u0010\u001c¨\u00066"}, d2 = {"Lcom/soundcloud/android/share/InstagramStoriesApi;", "", "instagramPackageHelper", "Lcom/soundcloud/android/share/InstagramPackageHelper;", "grantUriPermissionWrapper", "Lcom/soundcloud/android/share/InstagramStoriesApi$GrantUriPermissionWrapper;", "errorReporter", "Lcom/soundcloud/android/error/reporting/ErrorReporter;", "appFeatures", "Lcom/soundcloud/android/properties/AppFeatures;", "trackArtworkProvider", "Lcom/soundcloud/android/share/TrackArtworkProvider;", "sharingStickerUriProvider", "Lcom/soundcloud/android/share/SharingStickerUriProvider;", "trackRepository", "Lcom/soundcloud/android/foundation/domain/tracks/TrackRepository;", "scheduler", "Lio/reactivex/Scheduler;", "(Lcom/soundcloud/android/share/InstagramPackageHelper;Lcom/soundcloud/android/share/InstagramStoriesApi$GrantUriPermissionWrapper;Lcom/soundcloud/android/error/reporting/ErrorReporter;Lcom/soundcloud/android/properties/AppFeatures;Lcom/soundcloud/android/share/TrackArtworkProvider;Lcom/soundcloud/android/share/SharingStickerUriProvider;Lcom/soundcloud/android/foundation/domain/tracks/TrackRepository;Lio/reactivex/Scheduler;)V", "getAppFeatures", "()Lcom/soundcloud/android/properties/AppFeatures;", "getScheduler", "()Lio/reactivex/Scheduler;", "getSharingStickerUriProvider", "()Lcom/soundcloud/android/share/SharingStickerUriProvider;", "getTrackArtworkProvider", "()Lcom/soundcloud/android/share/TrackArtworkProvider;", "getTrackRepository", "()Lcom/soundcloud/android/foundation/domain/tracks/TrackRepository;", "createInstagramIntent", "Landroid/content/Intent;", "activity", "Landroidx/fragment/app/FragmentActivity;", "params", "Lcom/soundcloud/android/share/InstagramStoriesApi$InstagramParams;", "deleteStickerAndImageFiles", "", "formatArtworkImageUrl", "", "imageUrlTemplate", "getShareIntent", "Lio/reactivex/Single;", "trackUrn", "Lcom/soundcloud/android/foundation/domain/Urn;", "getTrackArtworkUri", "Landroid/net/Uri;", "track", "Lcom/soundcloud/android/foundation/domain/tracks/Track;", "setBackgroundAsset", "Companion", "DeleteFileObserver", "GrantUriPermissionWrapper", "InstagramParams", "IntentNotResolved", "base_release"}, mv = {1, 1, 15})
/* renamed from: Qwa reason: default package and case insensitive filesystem */
/* compiled from: InstagramStoriesApi.kt */
public class C5252Qwa {
    private static final TimeUnit a = TimeUnit.SECONDS;
    public static final a b = new a(null);
    /* access modifiers changed from: private */
    public final C5222Pwa c;
    private final c d;
    /* access modifiers changed from: private */
    public final C3469VY e;
    private final com.soundcloud.android.properties.a f;
    private final C7575vxa g;
    private final C7230qxa h;
    private final C3760eea i;
    private final HPa j;

    /* renamed from: Qwa$a */
    /* compiled from: InstagramStoriesApi.kt */
    public static final class a {
        private a() {
        }

        public /* synthetic */ a(C7264rYa rya) {
            this();
        }
    }

    /* renamed from: Qwa$b */
    /* compiled from: InstagramStoriesApi.kt */
    public final class b extends C4943Gua {
        public b() {
        }

        public void a(Throwable th) {
            C7471uYa.b(th, "e");
            defpackage.C3469VY.a.a(C5252Qwa.this.e, th, null, 2, null);
        }
    }

    /* renamed from: Qwa$c */
    /* compiled from: InstagramStoriesApi.kt */
    public static class c {
        public void a(FragmentActivity fragmentActivity, String str, Uri uri) {
            C7471uYa.b(fragmentActivity, "activity");
            C7471uYa.b(str, "packageName");
            C7471uYa.b(uri, "uri");
            fragmentActivity.grantUriPermission(str, uri, 1);
        }
    }

    /* renamed from: Qwa$d */
    /* compiled from: InstagramStoriesApi.kt */
    public static final class d {
        private final Uri a;
        private final Uri b;
        private final String c;

        public d(Uri uri, Uri uri2, String str) {
            C7471uYa.b(uri, "artworkUri");
            C7471uYa.b(uri2, "stickerUri");
            C7471uYa.b(str, "trackPermalink");
            this.a = uri;
            this.b = uri2;
            this.c = str;
        }

        public final Uri a() {
            return this.a;
        }

        public final Uri b() {
            return this.b;
        }

        public final String c() {
            return this.c;
        }

        /* JADX WARNING: Code restructure failed: missing block: B:8:0x0024, code lost:
            if (defpackage.C7471uYa.a((java.lang.Object) r2.c, (java.lang.Object) r3.c) != false) goto L_0x0029;
         */
        public boolean equals(Object obj) {
            if (this != obj) {
                if (obj instanceof d) {
                    d dVar = (d) obj;
                    if (C7471uYa.a((Object) this.a, (Object) dVar.a)) {
                        if (C7471uYa.a((Object) this.b, (Object) dVar.b)) {
                        }
                    }
                }
                return false;
            }
            return true;
        }

        public int hashCode() {
            Uri uri = this.a;
            int i = 0;
            int hashCode = (uri != null ? uri.hashCode() : 0) * 31;
            Uri uri2 = this.b;
            int hashCode2 = (hashCode + (uri2 != null ? uri2.hashCode() : 0)) * 31;
            String str = this.c;
            if (str != null) {
                i = str.hashCode();
            }
            return hashCode2 + i;
        }

        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append("InstagramParams(artworkUri=");
            sb.append(this.a);
            sb.append(", stickerUri=");
            sb.append(this.b);
            sb.append(", trackPermalink=");
            sb.append(this.c);
            sb.append(")");
            return sb.toString();
        }
    }

    /* renamed from: Qwa$e */
    /* compiled from: InstagramStoriesApi.kt */
    public static final class e extends Exception {
        public e() {
            super("Instagram intent cannot be resolved");
        }
    }

    public C5252Qwa(C5222Pwa pwa, c cVar, C3469VY vy, com.soundcloud.android.properties.a aVar, C7575vxa vxa, C7230qxa qxa, C3760eea eea, HPa hPa) {
        C7471uYa.b(pwa, "instagramPackageHelper");
        C7471uYa.b(cVar, "grantUriPermissionWrapper");
        C7471uYa.b(vy, "errorReporter");
        C7471uYa.b(aVar, "appFeatures");
        C7471uYa.b(vxa, "trackArtworkProvider");
        C7471uYa.b(qxa, "sharingStickerUriProvider");
        C7471uYa.b(eea, "trackRepository");
        C7471uYa.b(hPa, "scheduler");
        this.c = pwa;
        this.d = cVar;
        this.e = vy;
        this.f = aVar;
        this.g = vxa;
        this.h = qxa;
        this.i = eea;
        this.j = hPa;
    }

    public C7230qxa c() {
        return this.h;
    }

    public C7575vxa d() {
        return this.g;
    }

    public C3760eea e() {
        return this.i;
    }

    public HPa b() {
        return this.j;
    }

    public IPa<Intent> a(FragmentActivity fragmentActivity, C3508cda cda) {
        C7471uYa.b(fragmentActivity, "activity");
        C7471uYa.b(cda, "trackUrn");
        IPa<Intent> b2 = Nda.a(e().a(cda, defpackage.C3760eea.a.SYNC_MISSING)).d((C7118pQa<? super T, ? extends MPa<? extends R>>) new C5341Twa<Object,Object>(this, fragmentActivity)).e(new C5370Uwa(this, fragmentActivity)).e(new C5399Vwa(this, fragmentActivity)).b(21, a, b());
        C7471uYa.a((Object) b2, "trackRepository.track(tr…OUT_TIME_UNIT, scheduler)");
        return b2;
    }

    public void a() {
        d().a().c(new b());
        c().a().c(new b());
    }

    /* access modifiers changed from: private */
    public IPa<Uri> a(C3509cea cea) {
        if (cea.k() == null) {
            IPa<Uri> a2 = IPa.a(Uri.EMPTY);
            C7471uYa.a((Object) a2, "Single.just(Uri.EMPTY)");
            return a2;
        }
        C7575vxa d2 = d();
        String k = cea.k();
        if (k != null) {
            IPa<Uri> b2 = d2.a(a(k)).b(20, a, b());
            C7471uYa.a((Object) b2, "trackArtworkProvider.get…OUT_TIME_UNIT, scheduler)");
            return b2;
        }
        throw new IllegalStateException("Required value was null.");
    }

    private String a(String str) {
        String str2 = C3721b.T2480.m;
        C7471uYa.a((Object) str2, "ApiImageSize.T2480.sizeSpec");
        return Cxb.a(str, "{size}", str2, false, 4, (Object) null);
    }

    /* access modifiers changed from: private */
    public Intent a(FragmentActivity fragmentActivity, d dVar) {
        this.d.a(fragmentActivity, "com.instagram.android", dVar.b());
        Intent intent = new Intent("com.instagram.share.ADD_TO_STORY");
        intent.setFlags(1);
        a(intent, dVar);
        intent.putExtra("interactive_asset_uri", dVar.b());
        intent.putExtra("content_url", dVar.c());
        return intent;
    }

    private void a(Intent intent, d dVar) {
        String str = "image/jpeg";
        if (!C7471uYa.a((Object) dVar.a(), (Object) Uri.EMPTY)) {
            intent.setDataAndType(dVar.a(), str);
        } else {
            intent.setType(str);
        }
    }
}
